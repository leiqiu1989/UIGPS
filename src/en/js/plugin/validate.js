define(function(require,exports,module){function r(t,e){return this instanceof arguments.callee?(this.opts=$.extend(!0,{subBtn:"[type=submit]",subBtnWrap:!0,promptPos:"inline",submit:$.noop,reg:{tel:/^1\d{10}$/,phone:/^0\d{2,3}-\d{7,8}$/,amount:/^\d+(\.\d+)?$/,integer:/^\d*$/,number:/^\d+(\.\d{1,2})?$/,notAllNumber:/\D+/,email:/^.+@.+\..+$/},errorMsg:{required:"不能为空",tel:"请输入正确的手机号码",phone:"请输入正确的电话号码",equals:"输入不一致",amount:"请输入正确的金额",integer:"请输入整数",number:"请输入数字，最多两位小数点",notAllNumber:"不能全是数字",email:"请输入正确的邮箱"},labelReg:["notAllNumber","integer","number"]},e),this.el="string"==typeof t?$(t):t,this.subBtn=this.opts.subBtnWrap?this.el.find(this.opts.subBtn):$(this.opts.subBtn),this.promptPos=this.opts.promptPos,this.submitCb=this.opts.submit,this.errorAry=[],void this.init()):new r(t,e)}var t=require("./_dialog");r.prototype={init:function(){var r=this;r.subBtn.on("click",function(){r.checkForm()})},checkForm:function(){var r=this,e="dialog"==this.promptPos,i=this.opts,s=i.errorMsg;return this.errorAry=[],this.el.find(".error-tips").remove(),this.el.find("input, select, textarea").each(function(){var t=$(this),o=$.trim(t.val()),n=t.data("type"),a=this.type,d=i.reg[n],l=parseFloat($(this).attr("max")),p=$.inArray(n,r.opts.labelReg)>=0?!0:!1;if(r.getErrorEl(t).removeClass("input-error"),(r.hasAttr(t,"vingore")||"hidden"!=t.attr("type")&&!t.is(":hidden")&&!t.prop("disabled"))&&(r.hasAttr(t,"required")&&("checkbox"==a?!t.prop("checked")&&r.addError(t,s.required,e,!0):!o&&r.addError(t,s.required,e,!0)),d&&o&&!d.test(o)&&r.addError(t,s[n],e,p),l&&parseFloat(o)>=l&&r.addError(t,"不能超过"+l,e,p),r.hasAttr(t,"equals"))){var h=$('[name="'+t.attr("equals")+'"]').val();o&&h&&o!=h&&r.addError(t,s.equals,e,!0)}}),this.errorAry.length?void t('<div class="dialog-error"><p>'+this.errorAry.join("</p><p>")+"</p></div>"):void(this.el.find(".error-tips").length||this.submitCb.call(this))},addError:function(r,t,e,i){var s=i&&r.prev().length?$.trim(r.prev().text()).replace(/\：/g,""):"",o=r.siblings(".validate-tips"),t=o.length&&o.data("msg")?o.data("msg"):s+t,n='<i class="error-tips">'+t+"</i>",a=this.getErrorEl(r);a.addClass("input-error"),e?this.errorAry.push(t):o.length?o.append(n):a.after(n)},getErrorEl:function(r){var t=r.attr("errorselector");return t?$(t):r},hasAttr:function(r,t){return"undefined"!=typeof r.attr(t)}},module.exports=r});